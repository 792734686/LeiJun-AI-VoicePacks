function [SHP,DSHP] = shape_iTR3(s,t,ENC)
%ENC(3,2) --- nodes coordinate(X|Y)
b1 = ENC(2,2)-ENC(3,2);
b2 = ENC(3,2)-ENC(1,2);
b3 = ENC(1,2)-ENC(2,2);
c1 = ENC(3,1)-ENC(2,1);
c2 = ENC(1,1)-ENC(3,1);
c3 = ENC(2,1)-ENC(1,1);
% -----------------------
L1 = 1/3-s-t;
L2 = s+1/3;
L3 = t+1/3;
% --------------------------
Nu1s = (b2*(t + 1/3))/2 - (b3*(s + 1/3))/2 - b3*(s/2 + t/2 - 1/6);
Nu2s = (b3*(s + t - 1/3))/2 + (b1*(t + 1/3))/2 + b3*(s/2 + 1/6);
Nu3s = -(b1 + b2)*(t/2 + 1/6);
Nu1t = (b2*(t + 1/3))/2 - (b3*(s + 1/3))/2 + b2*(s/2 + t/2 - 1/6);
Nu2t = (b1 + b3)*(s/2 + 1/6);
Nu3t = - (b2*(s + t - 1/3))/2 - (b1*(s + 1/3))/2 - b2*(t/2 + 1/6);
Nv1s = (c2*(t + 1/3))/2 - (c3*(s + 1/3))/2 - c3*(s/2 + t/2 - 1/6);
Nv2s = (c3*(s + t - 1/3))/2 + (c1*(t + 1/3))/2 + c3*(s/2 + 1/6);
Nv3s = -(c1 + c2)*(t/2 + 1/6);
Nv1t = (c2*(t + 1/3))/2 - (c3*(s + 1/3))/2 + c2*(s/2 + t/2 - 1/6);
Nv2t = (c1 + c3)*(s/2 + 1/6);
Nv3t = - (c2*(s + t - 1/3))/2 - (c1*(s + 1/3))/2 - c2*(t/2 + 1/6);
L1s = -1;
L1t = -1;
L2s = 1;
L2t = 0;
L3s = 0;
L3t = 1;
% --------------------------------------------------
DSHP = [L1s,L2s,L3s;
        L1t,L2t,L3t;
        Nu1s,Nu2s,Nu3s;
        Nu1t,Nu2t,Nu3t;
        Nv1s,Nv2s,Nv3s;
        Nv1t,Nv2t,Nv3t];
SHP = [L1,L2,L3];
end