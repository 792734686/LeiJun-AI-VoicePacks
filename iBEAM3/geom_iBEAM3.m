function B = geom_iBEAM3(s,ENC)
% B ---- strain matrix
% s ---- local coordinate(gause point)
% ENC ---- node global coordinates,[x1|x2]
% ---------------------------
X1 = ENC(:,1);
X2 = ENC(:,2);
len = norm(X1-X2);
L2 = 0.5*[s*(s-1),2*(1-s^2),s*(s+1)];
L1s = [-0.5,0.5];
L2s = [0.5*(2*s-1),-2*s,0.5*(2*s+1)];
N3s = [len/24*(-6*s^2+6*s+2),len/24*(12*s^2-4),len/24*(-6*s^2-6*s+2)];
B11 = 2/len*[L1s(1),0,0,0,0,0];
B12 = 2/len*[L1s(2),0,0,0,0,0];
B21 = 2/len*[0,0,0,0,L2s(1),0];
B22 = 2/len*[0,0,0,0,L2s(3),0];
B31 = 2/len*[0,0,0,0,0,-L2s(1)];
B32 = 2/len*[0,0,0,0,0,-L2s(3)];
B41 = 2/len*[0,0,L1s(1),0,(N3s(1)+0.5*len*L2(1)),0];
B42 = 2/len*[0,0,L1s(2),0,(N3s(3)+0.5*len*L2(3)),0];
B51 = 2/len*[0,L1s(1),0,0,0,-(N3s(1)+0.5*len*L2(1))];
B52 = 2/len*[0,L1s(2),0,0,0,-(N3s(3)+0.5*len*L2(3))];
B61 = 2/len*[0,0,0,L1s(1),0,0];
B62 = 2/len*[0,0,0,L1s(2),0,0];
B2c = 2/len*[L2s(2),0];
B3c = 2/len*[0,-L2s(2)];
B4c = 2/len*[(N3s(2)+0.5*len*L2(2)),0];
B5c = 2/len*[0,-(N3s(2)+0.5*len*L2(2))];
% --------------------------------------------
oo = [0,0];
B = [B11,B12,oo;
    B21,B22,B2c;
    B31,B32,B3c;
    B41,B42,B4c;
    B51,B52,B5c;
    B61,B62,oo];

end